# 天気記録システム 仕様書

## 概要
Google スプレッドシートに今日の天気を記録するシステム

## 機能

### recordWeather() 関数

#### 目的
ユーザーが手動で入力した天気情報を、現在の日付と共にスプレッドシートに記録する

#### 処理フロー
1. アクティブなスプレッドシートのアクティブシートを取得
2. 現在の日付(今日)を取得
3. ユーザーインターフェースでプロンプトダイアログを表示
   - タイトル: 「天気を記録」
   - メッセージ: 「今日の天気を入力してください:」
   - ボタン: OK/キャンセル
4. ユーザーがキャンセルボタンを押した場合は処理を終了
5. ユーザーが入力した天気情報を取得
6. シートの最終行に日付と天気を追加

#### 入力
- なし(関数呼び出し時のパラメータなし)
- ユーザーからの手動入力: 天気の文字列

#### 出力
- スプレッドシートに以下の形式で1行追加:
  - 列1: 日付(Date型)
  - 列2: 天気(文字列)

#### 使用API
- `SpreadsheetApp.getActiveSpreadsheet()`: アクティブなスプレッドシートを取得
- `SpreadsheetApp.getUi()`: ユーザーインターフェースを取得
- `ui.prompt()`: プロンプトダイアログを表示
- `sheet.appendRow()`: シートに行を追加

#### エラーハンドリング
- キャンセルボタン押下時: 処理を中断し、何も記録しない

## 使用方法
1. Google スプレッドシートを開く
2. スクリプトエディタから `recordWeather()` 関数を実行
3. 表示されるダイアログに天気を入力してOKをクリック
4. スプレッドシートに日付と天気が記録される

## 必要な権限
- スプレッドシートの読み取り・書き込み権限

## ソースコード

```javascript
function recordWeather() {
  // スプレッドシートを取得
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();

  // 今日の日付を取得
  const today = new Date();

  // ユーザーに天気を入力してもらう
  const ui = SpreadsheetApp.getUi();
  const response = ui.prompt('天気を記録', '今日の天気を入力してください:', ui.ButtonSet.OK_CANCEL);

  // キャンセルされた場合は終了
  if (response.getSelectedButton() !== ui.Button.OK) {
    return;
  }

  const weather = response.getResponseText();

  // 日付と天気をスプレッドシートに追加
  sheet.appendRow([today, weather]);
}
```
